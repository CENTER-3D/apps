---

copyright:
  years: 2015, 2018
lastupdated: "2018-07-12"

---

{:shortdesc: .shortdesc}
{:tip: .tip}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:screen: .screen}

# 証明書署名要求の作成
{: #ssl_csr}

SSL 証明書をアップロードし、アプリケーションへのアクセスを制限することにより、アプリケーションを保護することができます。
{:shortdesc}

{{site.data.keyword.Bluemix}} で許可された SSL 証明書をアップロードするには、その前にご使用のサーバーで証明書署名要求 (CSR) を作成しなければなりません。CSR というのは、公開鍵と関連情報への署名を要求するために認証局に送信されるメッセージのことです。 通常、CSR は PKCS #10 フォーマットになっています。 CSR には、公開鍵と、共通名、組織、市区町村、都道府県、国、および E メールが組み込まれています。 SSL 証明書要求は、2048 ビット長の CSR 鍵を使用した場合のみ受理されます。

## 必要な CSR の内容

CSR を有効にするには、CSR の生成時に以下の情報を入力する必要があります。

### 国の名前

  国または地域の 2 桁のコード。例えば、`US` は米国の国別コードです。他の国や地域については、CSR を作成する前に、[ISO 国別コードのリスト ![「外部リンク」アイコン](../icons/launch-glyph.svg "「外部リンク」アイコン")](https://www.iso.org/obp/ui/#search){:new_window}を調べてください。

### 都道府県

  短縮されていない正式な都道府県の名称。

### 地域

  市区町村の正式名称。

### 組織

  その地域で法的に登録された法人もしくは企業の正式名称または個人名。 企業の場合は、必ず組織形態名 (Ltd.、Inc.、NV. など) を含めてください。

### 部門

  証明書を申請している会社の (経理や営業などの) 部門名。

### 共通名

  SSL 証明書の要求先サイトの完全修飾ドメイン名 (FQDN)。

CSR の作成方法は、ご使用のオペレーティング・システムによって様々です。 以下の例は、[OpenSSL コマンド・ライン・ツール ![「外部リンク」アイコン](../icons/launch-glyph.svg "「外部リンク」アイコン")](http://www.openssl.org/){:new_window}を使用して CSR を作成する方法を示しています。

```
openssl req -out CSR.csr -new -newkey rsa:2048 -nodes -keyout
    privatekey.key
```

OpenSSL SHA-512 が実装されるかどうかは、コンパイラーが 64 ビットの整数型をサポートしているかどうかで決まります。 SHA-256 の証明書に関して互換性の問題があるアプリケーションでは、SHA-1 オプションを使用してかまいません。
{: tip}

証明書は認証局によって発行され、その認証局によってデジタル署名されています。 CSR の作成後は、パブリック認証局に SSL 証明書を生成できます。

## SSL 証明書のアップロード
{: #ssl_certificate}

セキュリティー・プロトコルを適用して、アプリケーションの通信におけるプライバシーを提供することで、盗聴、不正アクセス、およびメッセージ偽造を防止することができます。

アカウント所有者が無料トライアル・アカウントを持っている場合、証明書をアップロードするにはアカウントをアップグレードする必要があります。

証明書をアップロードするには、その前に証明書署名要求を作成する必要があります。

カスタム・ドメインを使用して SSL 証明書を提供する場合、以下の地域エンドポイントを使用して、{{site.data.keyword.Bluemix_notm}} の組織の URL 経路を指定します。

* US-South - `secure.us-south.bluemix.net`
* US-East - `secure.us-east.bluemix.net`
* EU-DE - `secure.eu-de.bluemix.net`
* EU-GB - `secure.eu-gb.bluemix.net`
* AU-SYD - `secure.au-syd.bluemix.net`

アプリケーションの証明書をアップロードするには、次のステップに従ってください。

1. ダッシュボードに移動します。

2. アプリを選択して、そのアプリの詳細ビューを開きます。

3. **「経路」** > **「ドメインの管理」**をクリックします。

4. アクション列で、追加アクション・メニューから**「ドメイン」**をクリックして、組織を選択します。

5. 「SSL 証明書」列で**「アップロード」**をクリックして、カスタム・ドメインを選択します。

6. 証明書、秘密鍵、およびオプションで中間証明書またはクライアント証明書を、アップロードするよう参照します。 クライアント証明書トラストストアを有効にするには、許可されるユーザー・アクセスを定義するクライアント証明書トラストストア・ファイルをカスタム・ドメインにアップロードする必要があります。

  #### 証明書

    公開鍵を証明書所有者の ID にバインドして証明書の所有者を認証できるようにするデジタル文書。証明書は認証局によって発行され、その認証局によってデジタル署名されています。

    証明書は通常、認証局によって発行および署名されます。 ただし、テストおよび開発目的では、自己署名証明書を使用することができ
ます。

    {{site.data.keyword.Bluemix_notm}} では以下のタイプの証明書がサポートされています。

	* PEM (`pem`、`.crt`、`.cer`、および `.cert`)
	* DER (`.der` または `.cer`)
	* PKCS #7 (`p7b`、`p7r`、`spc`)

  #### 秘密鍵

    対応する公開鍵のみが暗号化解除できるメッセージを暗号化するために使用される算法パターン。秘密鍵は、対応する公開鍵によって暗号化されたメッセージの暗号化解除にも使用されます。 秘密鍵はユーザーのシステム上に保持され、パスワードによって保護されています。

    {{site.data.keyword.Bluemix_notm}} では以下のタイプの秘密鍵がサポートされています。

    * PEM (`pem`、`.key`)
    * PKCS #8 (`p8`、`pk8`)

  #### 中間証明書

    特にエンド・エンティティー・サーバー証明書を発行する目的で、トラステッド・ルート認証局 (CA) によって発行される、従属証明書。 その結果として、トラステッド・ルート CA から始まり、中間証明書を経て、組織に発行される SSL 証明書に至る、証明書チェーンが形成されます。

    中間証明書を使用して、メイン証明書の認証性を検証します。中間証明書は通常、信頼のおける第三者機関から取得します。アプリケーションを実動環境にデプロイする前にテストする際には、中間証明書が不要な場合もあります。

  #### クライアント証明書の要求の有効化

    クライアント証明書トラストストア・ファイルをアップロードすることによってこのオプションを有効にすると、SSL で保護されたドメインにアクセスしようとするユーザーは、クライアント・サイド証明書を提供するよう要求されます。 例えば、Web ブラウザーでユーザーが SSL で保護されたドメインにアクセスしようとすると、Web ブラウザーは、そのドメインのクライアント証明書を提供するようユーザーにプロンプトを出します。 **「クライアント証明書トラストストア」**ファイルのアップロード・オプションを使用して、カスタム・ドメインへのアクセスを許可するクライアント・サイドの証明書を定義します。

  **注:** {{site.data.keyword.Bluemix_notm}} ドメイン管理のカスタム証明書機能は、トランスポート層セキュリティー (TLS) プロトコルのサーバー名表示 (SNI) 拡張機能に依存します。 カスタム証明書で保護されている {{site.data.keyword.Bluemix_notm}} アプリケーションにアクセスするクライアント・コードは、TLS 実装の SNI 拡張機能をサポートする必要があります。詳細については、[RFC 4346 のセクション 7.4.2 ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン")](http://tools.ietf.org/html/rfc4346#section-7.4.2){:new_window} および『[TLS を使用したデータの保護 (Securing data with TLS)](/docs/get-support/appsectls.html)』を参照してください。

  #### クライアント証明書トラストストア

  クライアント証明書トラストストアには、アプリケーションへのアクセスを許可するユーザー用のクライアント証明書が含まれています。クライアント証明書を要求するオプションを有効にするには、クライアント証明書トラストストア・ファイルをアップロードします。

   {{site.data.keyword.Bluemix_notm}} では以下のタイプの証明書がサポートされています。

      * PEM (pem、.crt、.cer、および .cert)
      * PKCS #7 (p7b、p7r、spc)

  メタデータに公開鍵を含んでいるクライアント証明書トラストストアをアップロードすることで、相互認証をセットアップできます。
  {: tip}

詳しくは、『[SSL 証明書のインポート](/docs/infrastructure/ssl-certificates/import-ssl-certificate.html#import-an-ssl-certificate)』を参照してください。

証明書を削除したり、既存の証明書を新しい証明書に置き換えたりするには、次のステップに従います。

1. **「管理」**>**「アカウント」**>**「Cloud Foundry の組織」**に移動します。
2. アクション列で追加アクション・メニューから**「ドメイン」**を選択します。組織に対する追加アクション・メニューで**「組織から削除」**をクリックします。
